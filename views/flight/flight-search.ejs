<%- include('../partials/header.ejs') %>
  <%- include('../partials/topservice.ejs') %>



    <% if (data && data.status==='success' && data.flights && data.flights.length> 0) { %>

      <div class="flight-list">

        <% data.flights.forEach(function (flight) { const leg=flight?.Bonds?.[0]?.Legs?.[0] || {}; const
          airlineName=leg.AirlineName || "Airline" ; const airlineCode=leg.AirlineCode || "XX" ; const
          flightNo=leg.FlightNumber || "" ; const departTime=leg.DepTime || "--:--" ; const arriveTime=leg.ArrTime
          || "--:--" ; const fromCity=leg.Origin || "DEL" ; const toCity=leg.Destination || "BOM" ; const
          duration=leg.Duration || "Non-stop" ; const price=flight?.Fare?.PublishedFare || 0; const
          traceId=data.TraceId; const itineraryKey=flight.ItineraryKey; %>

          <!-- FLIGHT CARD -->
          <div class="flight-card">

            <!-- AIRLINE -->
            <div class="airline">
              <div>
                <strong>
                  <%= airlineName %>
                </strong>
                <div class="flight-no">
                  <%= airlineCode %>
                    <%= flightNo %>
                </div>
              </div>
            </div>

            <!-- TIMING -->
            <div class="timing">
              <div>
                <strong>
                  <%= departTime %>
                </strong>
                <small>
                  <%= fromCity %>
                </small>
              </div>

              <div class="duration">
                <small>
                  <%= duration %>
                </small>
                <span>Non-stop</span>
              </div>

              <div>
                <strong>
                  <%= arriveTime %>
                </strong>
                <small>
                  <%= toCity %>
                </small>
              </div>
            </div>

            <input type="hidden" id="FlightAvailabilityRQ" value='<%- JSON.stringify(data.FlightAvailabilityRQ) %>'>

            <!-- PRICE -->
            <div class="price">
              <div class="amount">₹ <%= price %>
              </div>

              <!-- ✅ ACTION BASED BUTTON -->
              <button class="book-btn js-flight-action" data-action="BOOK_FLIGHT" data-traceid="<%= traceId %>"
                data-itinerarykey="<%= itineraryKey %>"> BOOK NOW</button>

              <small class="note">Limited seats</small>
            </div>

          </div>
          <!-- END CARD -->

          <% }); %>

      </div>

      <% } else { %>
        <p>No flights found</p>
        <% } %>



          <!--Flight search list-->
          <div class="flight-search comonmarpad">
            <div class="container">
              <div class="row">


                <div class="col-md-4"></div>
                <div class="col-md-8">


                  <div class="flight-card premium">
                    <div class="flight-main">

                      <div class="airline">
                        <img src="/images/SG.png" alt="SpiceJet">
                        <span class="code">SG-105</span>
                      </div>

                      <div class="time-box">
                        <h3>21:20</h3>
                        <span>Delhi</span>
                      </div>

                      <div class="duration">
                        <p>02h 25m</p>
                        <small>Non-stop</small>
                      </div>

                      <div class="time-box">
                        <h3>23:45</h3>
                        <span>Mumbai</span>
                      </div>

                      <div class="price-section">
                        <h3 class="price">₹9,496</h3>
                        <input type="radio" checked>
                      </div>
                    </div>

                    <div class="footer-link">
                      <a href="#">Flight Detail</a>
                    </div>
                  </div>




                </div>


              </div>
            </div>
          </div>



          <%- include('../partials/footer.ejs') %>